# docker-compose.mesh-app.yml
# Generated by Isle-Mesh scaffold from docker-compose.yml
# This compose file integrates your application with Isle-Mesh proxy and SSL

version: '3.8'

networks:
  mesh-convert-manual_meshnet:
    driver: bridge

services:
  # Mesh Proxy Service
  mesh-proxy:
    image: nginx:alpine
    container_name: mesh-convert-manual_mesh_proxy
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./proxy/nginx-mesh-proxy.conf:/etc/nginx/nginx.conf:ro
      - ./ssl/certs:/etc/nginx/ssl/certs:ro
      - ./ssl/keys:/etc/nginx/ssl/keys:ro
    labels:
      mesh.domain: "mesh-app.local"
      mesh.enabled: "true"
    networks:
      - mesh-convert-manual_meshnet
    depends_on:
      - python-api

  # Service: python-api
  python-api:
    build: .
    container_name: python-api
    ports:
      - "5000:5000"
    environment:
      - ENVIRONMENT=development
      - PORT=5000
      - API_KEY=test-api-key-123
    labels:
      mesh.subdomain: "api"
      mesh.mtls: "false"
    networks:
      - mesh-convert-manual_meshnet
    env_file:
      - ./config/.env
